[{"uri":"https://noissefnoc.github.io/","title":"","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/archive/","title":"Archive","tags":[],"categories":[],"series":[],"description":"Archive Page","content":"archive page\n"},{"uri":"https://noissefnoc.github.io/tags/bigquery/","title":"bigquery","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/posts/bigquery-gis-to-datastudio/","title":"Bigquery GIS のデータを Google DataStudio で使う方法","tags":["bigquery","datastudio","gis","sql"],"categories":[],"series":[],"description":"","content":" tl;dr Google BigQuery の GEOGRAPHY データ型はそのままでは Google DataStudio では使えないので(取り込み対象カラムとして表示されない)以下のように変換しておく必要がある。\nSELECT CONCAT(CAST(ST_Y(p) AS STRING), \u0026quot;,\u0026quot;, CAST(ST_X(p) AS STRING)) AS lat_lng FROM my_project.geo_table  このさい\n GEOGRAPHY データ型  (経度, 緯度) で保存されている (つまり ST_Y で緯度、 ST_X で経度が取れるということ)  DataStudio の緯度経度型  緯度,経度 のフォーマットを期待している   と、緯度経度の順番が逆になっていることに注意。\n本文 きっかけ Google BigQuery の地理情報をデータポータルで可視化する仕事があったが、データポータルの BigQuery テーブル指定だと GEOGRAPHY 型のカラムが出てこなかった。\n対応 データポータルで読み取れるのは緯度経度なので\n BigQuery であらかじめ変換したテーブルを用意しておく データポータルの BigQuery 取得でカスタムクエリを書く  の方法が考えられますが、今回は後者を選びました。\nカスタムクエリに以下のようなクエリをセットして\n-- カスタムクエリに記載するクエリ SELECT -- その他のカラム CONCAT(CAST(ST_Y(p) AS STRING), \u0026quot;,\u0026quot;, CAST(ST_X(p) AS STRING)) AS lat_lng FROM my_project.geo_table -- その他絞り込み条件  データポータルのカラムの設定マッピングで「地理フィールド」\u0026gt;「緯度/経度」を選択して完了です。\nReference  BigQuery GIS の構文リファレンス - ST_X: SQL のサンプルの記載がある データポータルのヘルプ - 地図のリファレンス：「地理フィールド」の「緯度 / 経度」の箇所  "},{"uri":"https://noissefnoc.github.io/categories/","title":"Categories","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/tags/datastudio/","title":"datastudio","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/tags/gis/","title":"gis","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/posts/","title":"Posts","tags":["index"],"categories":[],"series":[],"description":"Post page","content":""},{"uri":"https://noissefnoc.github.io/tags/sql/","title":"sql","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/tags/","title":"Tags","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/categories/tips/","title":"tips","tags":[],"categories":[],"series":[],"description":"","content":""},{"uri":"https://noissefnoc.github.io/series/","title":"Series","tags":[],"categories":[],"series":[],"description":"","content":""}]